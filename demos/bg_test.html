
<!DOCTYPE HTML>
<html lang="en">

<!-- Mirrored from creativejs.com/uploads/tutorials/three/Part1_particles/ThreeParticles.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 16 Jan 2016 12:05:42 GMT -->

<head>
    <title>three.js particle tutorial</title>
    <meta charset="utf-8">

    <style>
        html,body{width:100%; height:100%;}
        body {
            margin:0;
            font-family: '微软雅黑';
            font-size: 15px;
            line-height: 18px;
            overflow: hidden;
            background:url(../imgs/home_bg.jpg) no-repeat center center;
            background-size:cover;
        }

        canvas { width: 100%; height: 100% }
        #starsky{
            width:100%;
            height:100%;
        }
    </style>

</head>

<body>
<div id="starsky"></div>
<script src="https://cdn.bootcss.com/jquery/2.0.2/jquery.js"></script>
<script src="http://techbrood.com/threejs/build/three.min.js"></script>
<script src="https://threejs.org/examples/js/libs/stats.min.js"></script>
<script src="http://techbrood.com/threejs/examples/js/controls/OrbitControls.js"></script>

<script>
var Starsky = function ($element) {
    var starsky = this;
    var mouseX = 0,
        mouseY = 0;
    //灯光
    starsky.LightInit = function () {
        var ambientLight = new THREE.AmbientLight(0xffffff);
        starsky.scene.add(ambientLight); //光源添加到场景中
    }
    //动画
    starsky.Animate = function () {
        var time = Date.now() * 0.00005;
        starsky.camera.position.x += (mouseX - starsky.camera.position.x) * 0.05;
        starsky.camera.position.y += (-mouseY - starsky.camera.position.y) * 0.05;
        starsky.camera.lookAt(starsky.scene.position);
        for (var i = 0; i < starsky.scene.children.length; i++) {
            var object = starsky.scene.children[i];
            if (object instanceof THREE.Points) {
                object.rotation.y = time * (i < 4 ? i + 1 : -(i + 1));
            }
        }
        requestAnimationFrame(starsky.Animate);
        starsky.renderer.render(starsky.scene, starsky.camera);
    }
    //创建天空
    starsky.CreateSky = function(){
        var starsGeometry = new THREE.Geometry();
        for ( var i = 0; i < 1000; i ++ ) {
            var star = new THREE.Vector3();
            star.x = THREE.Math.randFloatSpread( 100 );
            star.y = THREE.Math.randFloatSpread( 100 );
            star.z = THREE.Math.randFloatSpread( 100 );
            starsGeometry.vertices.push( star );
        }
        var textureLoader = new THREE.TextureLoader();
        var sprite = textureLoader.load('../imgs/snowflake1.png');
        var starsMaterial = new THREE.PointsMaterial( {
            color: 0xfffffff,
            size:Math.random()*1,
            map: sprite,
        } );
        var starField = new THREE.Points( starsGeometry, starsMaterial );
        starsky.scene.add( starField );
    }
    //窗口变化
    starsky.WindowSize = function () {
        window.onresize = function () {
            var w = $element.width();
            var h = $element.height();
            starsky.camera.aspect = w / h;
            starsky.camera.updateProjectionMatrix();
            starsky.renderer.setSize(w, h);
        }
    }
    //初始化
    starsky.init = function () {
        starsky.scene = new THREE.Scene();
        starsky.camera = new THREE.PerspectiveCamera(75, $element.width() / $element.height(), 0.1, 50);
        starsky.camera.position.z = 10;
        starsky.renderer = new THREE.WebGLRenderer({
            antialias: true,
            alpha: true
        });
        starsky.renderer.setPixelRatio(window.devicePixelRatio);
        starsky.renderer.setSize($element.width(), $element.height());

        $element.empty();
        $element.append(starsky.renderer.domElement);

        // 坐标线
        var axesHelper = new THREE.AxesHelper(100);
        starsky.scene.add(axesHelper);

        starsky.LightInit();
        starsky.CreateSky();
        starsky.Animate();
        starsky.WindowSize();
    }();
}

var Starsky = new Starsky($("#starsky"));

</script>
</body>

</html>
